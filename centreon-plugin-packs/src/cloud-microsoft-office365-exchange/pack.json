{
    "autodiscovery": {
        "rules": []
    },
    "commands": [
        {
            "line": "\\\"$CENTREONPLUGINS$\\\\/centreon_office365_exchange_api.pl --plugin=cloud::microsoft::office365::exchange::plugin --mode=mailbox-usage --tenant=\\'$_HOSTOFFICE365TENANT$\\' --client-id=\\'$_HOSTOFFICE365CLIENTID$\\' --client-secret=\\'$_HOSTOFFICE365CLIENTSECRET$\\' $_HOSTOFFICE365EXTRAOPTIONS$ --filter-mailbox=\\'$_SERVICEFILTERMAILBOX$\\' --warning-total-usage-active=\\'$_SERVICEWARNINGTOTALUSAGEACTIVE$\\' --critical-total-usage-active=\\'$_SERVICECRITICALTOTALUSAGEACTIVE$\\' --warning-total-usage-inactive=\\'$_SERVICEWARNINGTOTALUSAGEINACTIVE$\\' --critical-total-usage-inactive=\\'$_SERVICECRITICALTOTALUSAGEINACTIVE$\\' --warning-active-mailboxes=\\'$_SERVICEWARNINGACTIVEMAILBOXES$\\' --critical-active-mailboxes=\\'$_SERVICECRITICALACTIVEMAILBOXES$\\' --warning-items=\\'$_SERVICEWARNINGITEMS$\\' --critical-items=\\'$_SERVICECRITICALITEMS$\\' --warning-status=\\'$_SERVICEWARNINGSTATUS$\\' --critical-status=\\'$_SERVICECRITICALSTATUS$\\' --units=$_SERVICEUNITS$ --filter-counters=\\'$_SERVICEFILTERCOUNTERS$\\' $_SERVICEEXTRAOPTIONS$\\\"",
            "name": "Cloud-Microsoft-Office365-Exchange-Api-Mailbox-Usage",
            "type": "2"
        },
        {
            "line": "\\\"$CENTREONPLUGINS$\\\\/centreon_office365_exchange_api.pl --plugin=cloud::microsoft::office365::exchange::plugin --mode=email-activity --tenant=\\'$_HOSTOFFICE365TENANT$\\' --client-id=\\'$_HOSTOFFICE365CLIENTID$\\' --client-secret=\\'$_HOSTOFFICE365CLIENTSECRET$\\' $_HOSTOFFICE365EXTRAOPTIONS$ --filter-user=\\'$_SERVICEFILTERUSER$\\' --warning-total-send-count=\\'$_SERVICEWARNINGTOTALSENDCOUNT$\\' --critical-total-send-count=\\'$_SERVICECRITICALTOTALSENDCOUNT$\\' --warning-total-receive-count=\\'$_SERVICEWARNINGTOTALRECEIVECOUNT$\\' --critical-total-receive-count=\\'$_SERVICECRITICALTOTALRECEIVECOUNT$\\' --warning-total-read-count=\\'$_SERVICEWARNINGTOTALREADCOUNT$\\' --critical-total-read-count=\\'$_SERVICECRITICALTOTALREADCOUNT$\\' --warning-active-users=\\'$_SERVICEWARNINGACTIVEUSERS$\\' --critical-active-users=\\'$_SERVICECRITICALACTIVEUSERS$\\' --warning-send-count=\\'$_SERVICEWARNINGSENDCOUNT$\\' --critical-send-count=\\'$_SERVICECRITICALSENDCOUNT$\\' --warning-receive-count=\\'$_SERVICEWARNINGRECEIVECOUNT$\\' --critical-receive-count=\\'$_SERVICECRITICALRECEIVECOUNT$\\' --warning-read-count=\\'$_SERVICEWARNINGREADCOUNT$\\' --critical-read-count=\\'$_SERVICECRITICALREADCOUNT$\\' --units=$_SERVICEUNITS$ --filter-counters=\\'$_SERVICEFILTERCOUNTERS$\\' $_SERVICEEXTRAOPTIONS$\\\"",
            "name": "Cloud-Microsoft-Office365-Exchange-Api-Email-Activity",
            "type": "2"
        }
    ],
    "host_templates": [
        {
            "_comment": "{FR: Mod\u00e8le pour superviser Microsoft Office 365 Exchange via l'API}\r\n{EN: Template to check Microsoft Office 365 Exchange using API}",
            "active_checks_enabled": 2,
            "alias": "Template to check Microsoft Office 365 Exchange using API",
            "check_interval": 0,
            "check_timeperiod": "",
            "checks_enabled": 2,
            "command_name": null,
            "discovery_arguments": "",
            "discovery_command_name": "",
            "icon": "exchange-128.png",
            "macros": [
                {
                    "key": "$_HOSTOFFICE365TENANT$",
                    "value": ""
                },
                {
                    "key": "$_HOSTOFFICE365CLIENTID$",
                    "value": ""
                },
                {
                    "key": "$_HOSTOFFICE365CLIENTSECRET$",
                    "value": ""
                },
                {
                    "key": "$_HOSTOFFICE365EXTRAOPTIONS$",
                    "value": ""
                }
            ],
            "max_check_attempts": 0,
            "name": "Cloud-Microsoft-Office365-Exchange-Api",
            "notification_timeperiod": "",
            "parent_template": [
                "generic-dummy-host"
            ],
            "passive_checks_enabled": 2,
            "services": [
                "Cloud-Microsoft-Office365-Exchange-Mailbox-Usage-Api",
                "Cloud-Microsoft-Office365-Exchange-Email-Activity-Api"
            ],
            "snmp_community": null,
            "snmp_version": null
        }
    ],
    "images": [
        {
            "icon": "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",
            "name": "exchange-128.png"
        }
    ],
    "information": {
        "author": "Centreon",
        "changelog": "* update command options for mailbox-usage",
        "dependencies": [
            {
                "name": "base-generic",
                "version": "22.05.0"
            }
        ],
        "description": [
            {
                "lang": "en",
                "value": "Plugin pack to monitor Microsoft Office 365 Exchange :\r\n* Email activity\r\n* Mailbox usage"
            },
            {
                "lang": "fr",
                "value": "Plugin pack pour superviser Microsoft Office 365 Exchange :\r\n* Activit\u00e9 email\r\n* Utilisation des boites mail"
            }
        ],
        "discovery_category": "cloud",
        "email": "imp@centreon.com",
        "icon": "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",
        "monitoring_procedure": "# Monitoring procedure\r\n\r\n## Prerequisites\r\n\r\n### Centreon Plugin\r\nInstall this plugin on each needed poller:\r\n\r\n    # yum install centreon-plugin-Cloud-Microsoft-Office365-Exchange-Api\r\n\r\n### Perl dependencies\r\nBy installing the plugin, some perl depencies will be installed :\r\n\r\n    JSON::XS\r\n    Text::CSV\r\n    DateTime\r\n    Digest::MD5\r\n    Digest::SHA\r\n    LWP::UserAgent\r\n    LWP::Protocol::https\r\n    IO::Socket::SSL\r\n    URI\r\n    Encode\r\n    HTTP::ProxyPAC\r\n\r\n### Register an application\r\nTo connect to the Office 365 Graph API, you must register an application.\r\n\r\nFollow the 'How-to guide' in https://docs.microsoft.com/en-us/graph/auth-register-app-v2?view=graph-rest-1.0 for a complete explanation on how to register an application and get a client ID and secret.\r\n\r\n## Centreon Configuration\r\n\r\n### Create a new host\r\nGo to *Configuration &gt; Hosts* and click *Add*. Then, fill the form as\r\nshown by the following table:\r\n\r\n<table>\r\n<colgroup>\r\n<col width=\"58%\" />\r\n<col width=\"41%\" />\r\n</colgroup>\r\n<thead>\r\n<tr class=\"header\">\r\n<th align=\"left\">Field</th>\r\n<th align=\"left\">Value</th>\r\n</tr>\r\n</thead>\r\n<tbody>\r\n<tr class=\"odd\">\r\n<td align=\"left\"><p>Host name</p></td>\r\n<td align=\"left\"><p><em>Name of the host</em></p></td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td align=\"left\"><p>Alias</p></td>\r\n<td align=\"left\"><p><em>Host description</em></p></td>\r\n</tr>\r\n<tr class=\"odd\">\r\n<td align=\"left\"><p>IP</p></td>\r\n<td align=\"left\"><p><em>Host IP Address</em></p></td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td align=\"left\"><p>Monitored from</p></td>\r\n<td align=\"left\"><p><em>Monitoring Poller to use</em></p></td>\r\n</tr>\r\n<tr class=\"odd\">\r\n<td align=\"left\"><p>Host Multiple Templates</p></td>\r\n<td align=\"left\"><p>Cloud-Microsoft-Office365-Exchange-Api-custom</p></td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n\r\nClick on the *Save* button.\r\n\r\n### Set host macros\r\nThe following macros must be configured on host.\r\n\r\n<table>\r\n<colgroup>\r\n<col width=\"58%\" />\r\n<col width=\"41%\" />\r\n</colgroup>\r\n<thead>\r\n<tr class=\"header\">\r\n<th align=\"left\">Macro</th>\r\n<th align=\"left\">Description</th>\r\n</tr>\r\n</thead>\r\n<tbody>\r\n<tr class=\"odd\">\r\n<td align=\"left\"><p>OFFICE365CUSTOMMODE</p></td>\r\n<td align=\"left\"><p>Custom mode 'graphapi'</p></td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td align=\"left\"><p>OFFICE365TENANT</p></td>\r\n<td align=\"left\"><p>Office 365 tenant ID</p></td>\r\n</tr>\r\n<tr class=\"odd\">\r\n<td align=\"left\"><p>OFFICE365CLIENTID</p></td>\r\n<td align=\"left\"><p>Office 365 client ID</p></td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td align=\"left\"><p>OFFICE365CLIENTSECRET</p></td>\r\n<td align=\"left\"><p>Office 365 client secret</p></td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n\r\nClick on the *Save* button.",
        "name": "Office365 Exchange",
        "plugins_requirements": [
            {
                "executable_name": "centreon_office365_exchange_api.pl",
                "package_name": "centreon-plugin-Cloud-Microsoft-Office365-Exchange-Api",
                "package_version": "20220518"
            }
        ],
        "requirement": [],
        "slug": "cloud-microsoft-office365-exchange",
        "status": "stable",
        "status_message": "",
        "tags": [
            "Cloud",
            "Microsoft",
            "Office",
            "Office365",
            "Exchange",
            "Restapi"
        ],
        "update_date": "1601898094",
        "version": "22.05.0",
        "website": "www.centreon"
    },
    "schema_version": 1,
    "service_templates": [
        {
            "_comment": "{FR: Contr\u00f4le l'utilisation des boites mail.}\r\n\r\n{EN: Check mailbox usage.}",
            "active_checks_enabled": 2,
            "alias": "Users-Activity",
            "check_timeperiod": "",
            "command_name": "Cloud-Microsoft-Office365-Exchange-Api-Mailbox-Usage",
            "discovery_list_mode": "",
            "icon": "",
            "is_volatile": 2,
            "macros": [
                {
                    "description": "",
                    "key": "$_SERVICEWARNINGSTATUS$",
                    "password": false,
                    "value": "%{used} > %{issue_warning_quota}"
                },
                {
                    "description": "",
                    "key": "$_SERVICECRITICALSTATUS$",
                    "password": false,
                    "value": "%{used} > %{prohibit_send_quota}"
                },
                {
                    "description": "",
                    "key": "$_SERVICEUNITS$",
                    "password": false,
                    "value": "%"
                },
                {
                    "description": "",
                    "key": "$_SERVICEFILTERCOUNTERS$",
                    "password": false,
                    "value": "active|total"
                }
            ],
            "max_check_attempts": 0,
            "name": "Cloud-Microsoft-Office365-Exchange-Mailbox-Usage-Api",
            "normal_check_interval": 60,
            "notification_timeperiod": "",
            "parent_template": "generic-active-service",
            "passive_checks_enabled": 2,
            "retry_check_interval": 0
        },
        {
            "_comment": "{FR: Contr\u00f4le l'activit\u00e9 sur les boites mail.}\r\n\r\n{EN: Check activity in mailbox.}",
            "active_checks_enabled": 2,
            "alias": "Email-Activity",
            "check_timeperiod": "",
            "command_name": "Cloud-Microsoft-Office365-Exchange-Api-Email-Activity",
            "discovery_list_mode": "",
            "icon": "",
            "is_volatile": 2,
            "macros": [
                {
                    "description": "",
                    "key": "$_SERVICEUNITS$",
                    "password": false,
                    "value": "%"
                },
                {
                    "description": "",
                    "key": "$_SERVICEFILTERCOUNTERS$",
                    "password": false,
                    "value": "active|total"
                }
            ],
            "max_check_attempts": 0,
            "name": "Cloud-Microsoft-Office365-Exchange-Email-Activity-Api",
            "normal_check_interval": 60,
            "notification_timeperiod": "",
            "parent_template": "generic-active-service",
            "passive_checks_enabled": 2,
            "retry_check_interval": 0
        }
    ],
    "timeperiods": []
}
