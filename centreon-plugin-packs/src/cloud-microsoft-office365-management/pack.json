{
    "autodiscovery": {
        "rules": []
    },
    "commands": [
        {
            "line": "\\\"$CENTREONPLUGINS$\\\\/centreon_office365_management_api.pl --plugin=cloud::microsoft::office365::management::plugin --mode=service-status --tenant=\\'$_HOSTOFFICE365TENANT$\\' --client-id=\\'$_HOSTOFFICE365CLIENTID$\\' --client-secret=\\'$_HOSTOFFICE365CLIENTSECRET$\\' $_HOSTOFFICE365EXTRAOPTIONS$ --filter-service-name=\\'$_SERVICEFILTERSERVICENAME$\\' --warning-status=\\'$_SERVICEWARNINGSTATUS$\\' --critical-status=\\'$_SERVICECRITICALSTATUS$\\' $_SERVICEEXTRAOPTIONS$\\\"",
            "name": "Cloud-Microsoft-Office365-Management-Api-Service-Status",
            "type": "2"
        },
        {
            "line": "\\\"$CENTREONPLUGINS$\\\\/centreon_office365_management_api.pl --plugin=cloud::microsoft::office365::management::plugin --mode=app-credentials --tenant=\\'$_HOSTOFFICE365TENANT$\\' --client-id=\\'$_HOSTOFFICE365CLIENTID$\\' --client-secret=\\'$_HOSTOFFICE365CLIENTSECRET$\\' $_HOSTOFFICE365EXTRAOPTIONS$ --filter-app-name=\\'$_SERVICEFILTERAPPNAME$\\' --warning-key-status=\\'$_SERVICEWARNINGKEYSTATUS$\\' --critical-key-status=\\'$_SERVICECRITICALKEYSTATUS$\\' --warning-key-expires=\\'$_SERVICEWARNINGKEYEXPIRES$\\' --critical-key-expires=\\'$_SERVICECRITICALKEYEXPIRES$\\' --warning-password-status=\\'$_SERVICEWARNINGPASSWORDSTATUS$\\' --critical-password-status=\\'$_SERVICECRITICALPASSWORDSTATUS$\\' --warning-password-expires=\\'$_SERVICEWARNINGPASSWORDEXPIRES$\\' --critical-password-expires=\\'$_SERVICECRITICALPASSWORDEXPIRES$\\' $_SERVICEEXTRAOPTIONS$\\\"",
            "name": "Cloud-Microsoft-Office365-Management-Api-App-Credentials",
            "type": "2"
        }
    ],
    "host_templates": [
        {
            "_comment": "{FR: Mod\u00e8le pour superviser Microsoft Office 365 management via l'API}\r\n{EN: Template to check Microsoft Office 365 management using API}",
            "active_checks_enabled": 2,
            "alias": "Template to check Microsoft Office 365 management using API",
            "check_interval": 0,
            "check_timeperiod": "",
            "checks_enabled": 2,
            "command_name": null,
            "discovery_arguments": "",
            "discovery_command_name": "",
            "icon": "office365-128.png",
            "macros": [
                {
                    "key": "$_HOSTOFFICE365TENANT$",
                    "value": ""
                },
                {
                    "key": "$_HOSTOFFICE365CLIENTID$",
                    "value": ""
                },
                {
                    "key": "$_HOSTOFFICE365CLIENTSECRET$",
                    "value": ""
                },
                {
                    "key": "$_HOSTOFFICE365EXTRAOPTIONS$",
                    "value": ""
                }
            ],
            "max_check_attempts": 0,
            "name": "Cloud-Microsoft-Office365-Management-Api",
            "notification_timeperiod": "",
            "parent_template": [
                "generic-dummy-host"
            ],
            "passive_checks_enabled": 2,
            "services": [
                "Cloud-Microsoft-Office365-Management-Service-Status-Api"
            ],
            "snmp_community": null,
            "snmp_version": null
        }
    ],
    "images": [
        {
            "icon": "iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsSAAALEgHS3X78AAADSklEQVR42u3aT2jOcRzA8Wd6UivFUoRyeJ5picsOclFWDkpxkG3ZUi5KOKgdKCUpilrtMAe5iJqDkuTiQDs4OJCDpFEOiqIsB5LGvt7a7yA9P+2pZ0/P7/d5P/W+7s/zee373We/VSq+mn6l4doqOkbPaIbGaSAN16u+O2Ud+mC9iyHvpBv0jVKDZmmKRqjHd60cP+3r6DS9zhl6XnM0TWPU5ztZrKFXaS/dzQaZWpBXRQEG30sX6X2Lhp68Kjp/6N00So9ofokH71XRQYPvp8nspzF1UF4VbVrfUgHyqmjT+laEvCratL4VJa+KNq1vXhWub14Vrm8FzfVNAK5vAnB9E4DrmwBc3wTg+iYA1zcBuL4JwPVNAK5vAnB9E4Dr26L7lD1kuULHFx7D1taEBFDy9a3hoP/zXsQAUML1ralBhwVQgvWtJYOODMBBC8BBCyD4oAUQfNAC8B8WBCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAALotG/wJZ2jLQKIA6A0QxdA8KELIPjQBRB86AIIPvTIABx6QAAOPTiADbSfLtNVOkOHaIBqaai2XAAlBvDPN7uZztKLvz7JL/pAT+g2jdPJDM02WpsO1LoEUAIAi8CQ13d6Qw/pOp2nI7Q7+zgrBFDgP7U3iSGvz/Sc7tEknaKDtIM2UlUABXjW0iIMjfpJ7+gx3aJLdIL2UT+tTqO9Auikh21LiCGvr/SKHtC17HMfpl20KQ3VuwUQB0Oj5ukjPaU7NEFjNEjbaX0arC0TQAwMef2gtzRNN+kCHaU9tJVWCiAOhry+ZF/vfQGIQQBiEIAYBCCGDmku+wX2z3bTV/YHMWJYaJamaIR6oj6Vi4ZhJnvwNpCG69WKr9JjiHO0i8GjPTIGj/ZgGDzaA2LwaA+IwaM9GAaP9oAYPNoDYij00f4bkqqlNICcEh0AAAAASUVORK5CYII=",
            "name": "office365-128.png"
        }
    ],
    "information": {
        "author": "Centreon",
        "changelog": "* add app-credentials service",
        "dependencies": [
            {
                "name": "base-generic",
                "version": "22.05.0"
            }
        ],
        "description": [
            {
                "lang": "en",
                "value": "Plugin pack to monitor Microsoft Office 365 management tasks:\r\n* Application credentials\r\n* Services status"
            },
            {
                "lang": "fr",
                "value": "Plugin pack pour superviser les t\u00e2ches de gestion Microsoft Office 365 :\r\n* Application credentials\r\n* Statut des services"
            }
        ],
        "discovery_category": "cloud",
        "email": "imp@centreon.com",
        "icon": "iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsSAAALEgHS3X78AAADSklEQVR42u3aT2jOcRzA8Wd6UivFUoRyeJ5picsOclFWDkpxkG3ZUi5KOKgdKCUpilrtMAe5iJqDkuTiQDs4OJCDpFEOiqIsB5LGvt7a7yA9P+2pZ0/P7/d5P/W+7s/zee373We/VSq+mn6l4doqOkbPaIbGaSAN16u+O2Ud+mC9iyHvpBv0jVKDZmmKRqjHd60cP+3r6DS9zhl6XnM0TWPU5ztZrKFXaS/dzQaZWpBXRQEG30sX6X2Lhp68Kjp/6N00So9ofokH71XRQYPvp8nspzF1UF4VbVrfUgHyqmjT+laEvCratL4VJa+KNq1vXhWub14Vrm8FzfVNAK5vAnB9E4DrmwBc3wTg+iYA1zcBuL4JwPVNAK5vAnB9E4Dr26L7lD1kuULHFx7D1taEBFDy9a3hoP/zXsQAUML1ralBhwVQgvWtJYOODMBBC8BBCyD4oAUQfNAC8B8WBCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAALotG/wJZ2jLQKIA6A0QxdA8KELIPjQBRB86AIIPvTIABx6QAAOPTiADbSfLtNVOkOHaIBqaai2XAAlBvDPN7uZztKLvz7JL/pAT+g2jdPJDM02WpsO1LoEUAIAi8CQ13d6Qw/pOp2nI7Q7+zgrBFDgP7U3iSGvz/Sc7tEknaKDtIM2UlUABXjW0iIMjfpJ7+gx3aJLdIL2UT+tTqO9Auikh21LiCGvr/SKHtC17HMfpl20KQ3VuwUQB0Oj5ukjPaU7NEFjNEjbaX0arC0TQAwMef2gtzRNN+kCHaU9tJVWCiAOhry+ZF/vfQGIQQBiEIAYBCCGDmku+wX2z3bTV/YHMWJYaJamaIR6oj6Vi4ZhJnvwNpCG69WKr9JjiHO0i8GjPTIGj/ZgGDzaA2LwaA+IwaM9GAaP9oAYPNoDYij00f4bkqqlNICcEh0AAAAASUVORK5CYII=",
        "monitoring_procedure": "# Monitoring procedure\r\n\r\n## Prerequisites\r\n\r\n### Centreon Plugin\r\nInstall this plugin on each needed poller:\r\n\r\n    # yum install centreon-plugin-Cloud-Microsoft-Office365-Management-Api\r\n\r\n### Perl dependencies\r\nBy installing the plugin, some perl depencies will be installed :\r\n\r\n    JSON::XS\r\n    DateTime\r\n    Digest::MD5\r\n    Digest::SHA\r\n    LWP::UserAgent\r\n    LWP::Protocol::https\r\n    IO::Socket::SSL\r\n    URI\r\n    HTTP::ProxyPAC\r\n\r\n### Register an application\r\nTo connect to the Office 365 Management API, you must register an application.\r\n\r\nFollow the 'How-to guide' in https://docs.microsoft.com/en-us/office/office-365-management-api/get-started-with-office-365-management-apis#register-your-application-in-azure-ad for a complete explanation on how to register an application and get a client ID and secret.\r\n\r\n## Centreon Configuration\r\n\r\n### Create a new host\r\nGo to *Configuration &gt; Hosts* and click *Add*. Then, fill the form as\r\nshown by the following table:\r\n\r\n<table>\r\n<colgroup>\r\n<col width=\"58%\" />\r\n<col width=\"41%\" />\r\n</colgroup>\r\n<thead>\r\n<tr class=\"header\">\r\n<th align=\"left\">Field</th>\r\n<th align=\"left\">Value</th>\r\n</tr>\r\n</thead>\r\n<tbody>\r\n<tr class=\"odd\">\r\n<td align=\"left\"><p>Host name</p></td>\r\n<td align=\"left\"><p><em>Name of the host</em></p></td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td align=\"left\"><p>Alias</p></td>\r\n<td align=\"left\"><p><em>Host description</em></p></td>\r\n</tr>\r\n<tr class=\"odd\">\r\n<td align=\"left\"><p>IP</p></td>\r\n<td align=\"left\"><p><em>Host IP Address</em></p></td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td align=\"left\"><p>Monitored from</p></td>\r\n<td align=\"left\"><p><em>Monitoring Poller to use</em></p></td>\r\n</tr>\r\n<tr class=\"odd\">\r\n<td align=\"left\"><p>Host Multiple Templates</p></td>\r\n<td align=\"left\"><p>Cloud-Microsoft-Office365-Management-Api-custom</p></td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n\r\nClick on the *Save* button.\r\n\r\n### Set host macros\r\nThe following macros must be configured on host.\r\n\r\n<table>\r\n<colgroup>\r\n<col width=\"58%\" />\r\n<col width=\"41%\" />\r\n</colgroup>\r\n<thead>\r\n<tr class=\"header\">\r\n<th align=\"left\">Macro</th>\r\n<th align=\"left\">Description</th>\r\n</tr>\r\n</thead>\r\n<tbody>\r\n<tr class=\"odd\">\r\n<td align=\"left\"><p>OFFICE365CUSTOMMODE</p></td>\r\n<td align=\"left\"><p>Custom mode 'managementapi'</p></td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td align=\"left\"><p>OFFICE365TENANT</p></td>\r\n<td align=\"left\"><p>Office 365 tenant ID</p></td>\r\n</tr>\r\n<tr class=\"odd\">\r\n<td align=\"left\"><p>OFFICE365CLIENTID</p></td>\r\n<td align=\"left\"><p>Office 365 client ID</p></td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td align=\"left\"><p>OFFICE365CLIENTSECRET</p></td>\r\n<td align=\"left\"><p>Office 365 client secret</p></td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n\r\nClick on the *Save* button.",
        "name": "Office 365",
        "plugins_requirements": [
            {
                "executable_name": "centreon_office365_management_api.pl",
                "package_name": "centreon-plugin-Cloud-Microsoft-Office365-Management-Api",
                "package_version": "20220518"
            }
        ],
        "requirement": [],
        "slug": "cloud-microsoft-office365-management",
        "status": "stable",
        "status_message": "",
        "tags": [
            "Cloud",
            "Microsoft",
            "Office",
            "Office365",
            "Restapi"
        ],
        "update_date": "1643121308",
        "version": "22.05.0",
        "website": "www.centreon.com"
    },
    "schema_version": 1,
    "service_templates": [
        {
            "_comment": "{FR: Contr\u00f4le le statut des services.}\r\n\r\n{EN: Check services status.}",
            "active_checks_enabled": 2,
            "alias": "Service-Status",
            "check_timeperiod": "",
            "command_name": "Cloud-Microsoft-Office365-Management-Api-Service-Status",
            "discovery_list_mode": "",
            "icon": "",
            "is_volatile": 2,
            "macros": [
                {
                    "description": "",
                    "key": "$_SERVICECRITICALSTATUS$",
                    "password": false,
                    "value": "%{status} !~ /serviceOperational|serviceRestored/i"
                }
            ],
            "max_check_attempts": 0,
            "name": "Cloud-Microsoft-Office365-Management-Service-Status-Api",
            "normal_check_interval": 0,
            "notification_timeperiod": "",
            "parent_template": "generic-active-service",
            "passive_checks_enabled": 2,
            "retry_check_interval": 0
        },
        {
            "_comment": "{FR: Contr\u00f4le les credentials des applications.}\r\n\r\n{EN: Check application credentials expiration.}",
            "active_checks_enabled": 2,
            "alias": "App-Credentials",
            "check_timeperiod": "",
            "command_name": "Cloud-Microsoft-Office365-Management-Api-App-Credentials",
            "discovery_list_mode": "",
            "icon": "",
            "is_volatile": 2,
            "macros": [
                {
                    "description": "",
                    "key": "$_SERVICECRITICALKEYSTATUS$",
                    "password": false,
                    "value": "%{status} =~ /expired/i"
                },
                {
                    "description": "",
                    "key": "$_SERVICECRITICALPASSWORDSTATUS$",
                    "password": false,
                    "value": "%{status} =~ /expired/i"
                },
                {
                    "description": "",
                    "key": "$_SERVICEEXTRAOPTIONS$",
                    "password": false,
                    "value": "--verbose"
                }
            ],
            "max_check_attempts": 0,
            "name": "Cloud-Microsoft-Office365-Management-App-Credentials-Api",
            "normal_check_interval": 0,
            "notification_timeperiod": "",
            "parent_template": "generic-active-service",
            "passive_checks_enabled": 2,
            "retry_check_interval": 0
        }
    ],
    "timeperiods": []
}
