parameters:
    max_filesize: 2M
    max_file: 20
    post_max: 8M
services:
    _defaults:
        public: false
        autowire: true      # Automatically injects dependencies in your services.
        autoconfigure: true # Automatically registers your services as commands, event subscribers, controller...

    _instanceof:
        Core\Migration\Application\Repository\MigrationInterface:
            tags: ['platform.migrations']

    Core\Migration\:
        resource: '../../../../Core/Migration/*'

    Migrations\:
        resource: '../../../../Migrations/*'

    Core\Migration\Application\Repository\ReadAvailableMigrationRepositoryInterface:
        class: Core\Migration\Infrastructure\Repository\FsReadAvailableMigrationRepository
        arguments:
            $migrations: !tagged_iterator 'platform.migrations'
        public: true

    Core\Migration\Application\Repository\MigrationsCollectorRepositoryInterface:
        class: Core\Migration\Infrastructure\Repository\SymfonyMigrationsCollectorRepository
        arguments:
            $migrationsCollector: '@doctrine_migrations.migrations_collector'
        public: true

    Core\Migration\Application\Repository\WriteMigrationRepositoryInterface:
        class: Core\Migration\Infrastructure\Repository\DbWriteMigrationRepository
        arguments:
            $dependencyFactory: '@doctrine.migrations.dependency_factory'
            $migrationFactory: '@doctrine.migrations.migrations_factory'
            # $migratorConfigurationFactory: '@doctrine.migrations.configuration'
        public: true

    # Doctrine\Migrations\DependencyFactory:
    #     class: Doctrine\Migrations\DependencyFactory

    # Doctrine\Migrations\Version\MigrationPlanCalculator:
    #     class: Doctrine\Migrations\Version\SortedMigrationPlanCalculator

    # Doctrine\Migrations\MigrationsRepository:
    #     class: Doctrine\Migrations\FilesystemMigrationsRepository

    # Doctrine\Migrations\Metadata\Storage\MetadataStorage:
    #     class: Doctrine\Migrations\Metadata\Storage\TableMetadataStorage

    # Doctrine\Migrations\Version\Comparator:
    #     class: Doctrine\Migrations\Version\AlphabeticalComparator