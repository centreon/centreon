{
  "version": "1.1",
  "engine": "linux|Transformer|1.40.2|92f6ac93c667733b6f08c6d159d2a8be7625219b|2023-05-13_07:34:11PM",
  "containerized": false,
  "host_distro": {
    "name": "Ubuntu",
    "version": "22.04",
    "display_name": "Ubuntu 22.04.3 LTS"
  },
  "type": "build",
  "state": "error",
  "target_reference": "docker.centreon.com/centreon/centreon-web-alma9:MON-23368-containers",
  "system": {
    "type": "",
    "release": "",
    "distro": {
      "name": "",
      "version": "",
      "display_name": ""
    }
  },
  "source_image": {
    "identity": {
      "id": ""
    },
    "size": 0,
    "size_human": "",
    "create_time": "",
    "docker_version": "",
    "architecture": "",
    "container_entry": {
      "exe_path": ""
    }
  },
  "minified_image_size": 0,
  "minified_image_size_human": "",
  "minified_image": "",
  "minified_image_has_data": false,
  "minified_by": 0,
  "artifact_location": "",
  "container_report_name": "",
  "seccomp_profile_name": "",
  "apparmor_profile_name": "",
  "image_stack": [
    {
      "is_top_image": true,
      "id": "sha256:db125bdbe38d55a4b0e858055f41d32d131a1cac1a500d7b3f50182e1a0be3b3",
      "full_name": "docker.centreon.com/centreon/centreon-web-alma9:MON-23368-containers",
      "repo_name": "docker.centreon.com/centreon/centreon-web-alma9",
      "version_tag": "MON-23368-containers",
      "raw_tags": [
        "docker.centreon.com/centreon/centreon-web-alma9:MON-23368-containers"
      ],
      "create_time": "2024-01-11T16:03:59Z",
      "new_size": 1404927845,
      "new_size_human": "1.4 GB",
      "instructions": [
        {
          "type": "ADD",
          "time": "2023-11-28T23:28:25Z",
          "is_nop": true,
          "local_image_exists": false,
          "layer_index": 0,
          "size": 184018108,
          "size_human": "184 MB",
          "params": "file:9788b2efafa75575650a53daa65abb265da8eb6383be54f969f94c96c19ad82f in /",
          "command_snippet": "ADD file:9788b2efafa75575650a53daa65abb265da...",
          "command_all": "ADD file:9788b2efafa75575650a53daa65abb265da8eb6383be54f969f94c96c19ad82f /",
          "target": "/",
          "source_type": "file",
          "inst_set_time_bucket": "2023-11-29T00:15:00+01:00",
          "inst_set_time_index": 0,
          "inst_set_time_reverse_index": 2
        },
        {
          "type": "CMD",
          "time": "2023-11-28T23:28:26Z",
          "is_nop": true,
          "is_exec_form": true,
          "local_image_exists": false,
          "layer_index": 0,
          "size": 0,
          "params": "[\"/bin/bash\"]\n",
          "command_snippet": "CMD [\"/bin/bash\"]\n",
          "command_all": "CMD [\"/bin/bash\"]\n",
          "inst_set_time_bucket": "2023-11-29T00:15:00+01:00",
          "inst_set_time_index": 0,
          "inst_set_time_reverse_index": 2
        },
        {
          "type": "ARG",
          "time": "2024-01-11T02:18:05Z",
          "is_nop": false,
          "local_image_exists": false,
          "layer_index": 0,
          "size": 0,
          "params": "VERSION",
          "command_snippet": "ARG VERSION",
          "command_all": "ARG VERSION",
          "comment": "buildkit.dockerfile.v0",
          "is_buildkit_instruction": true,
          "inst_set_time_bucket": "2024-01-11T03:15:00+01:00",
          "inst_set_time_index": 1,
          "inst_set_time_reverse_index": 1
        },
        {
          "type": "RUN",
          "time": "2024-01-11T02:18:05Z",
          "is_nop": false,
          "local_image_exists": false,
          "layer_index": 0,
          "size": 1020590293,
          "size_human": "1.0 GB",
          "command_snippet": "RUN bash -e <<EOF dnf install -y dnf-plugins...",
          "command_all": "RUN bash -e <<EOF dnf install -y dnf-plugins-core dnf config-manager --set-enabled crb dnf install -y epel-release dnf config-manager --add-repo https://packages.centreon.com/rpm-standard/${VERSION}/el9/centreon-${VERSION}.repo dnf config-manager --set-enabled centreon* dnf install -y \n bc \n brotli \n bzip2 \n cronie \n httpd \n initscripts \n jq \n libsodium \n libunwind \n lua \n openpgm \n net-snmp \n net-snmp-perl \n net-snmp-utils \n openssl \n python3 \n rrdtool \n rrdtool-perl \n rsync \n sed \n sudo \n zeromq dnf install -y \n perl \n perl-DBD-MySQL \n perl-DBD-SQLite \n perl-DBI \n perl-EV \n perl-FFI-CheckLib \n perl-FFI-Platypus \n perl-HTML-Parser \n perl-NetAddr-IP \n perl-Net-Curl \n perl-Net-DNS \n perl-Net-HTTP \n perl-Net-Ping \n perl-Pod-Parser \n perl-Specio \n perl-Test-Simple \n perl-Unicode-Collate \n perl-XML-LibXML \n perl-XML-SAX \n perl-XML-Twig \n perl-UUID \n perltidy dnf install -y libfaketime dnf module enable -y php:8.1 dnf install -y \n php-common \n php-cli \n php-pdo \n php-mysqlnd \n php-gd \n php-xml \n php-mbstring \n php-ldap \n php-snmp \n php-intl \n php-fpm \n php-curl \n php-zip \n php-pear \n php-json curl -LsS https://r.mariadb.com/downloads/mariadb_repo_setup \n | bash -s -- --os-type=rhel --skip-check-installed --os-version=9 --mariadb-server-version=mariadb-10.5 dnf install -y mariadb-server mariadb echo [server]\nlog_output=FILE\ngeneral_log_file        = /var/lib/mysql/queries.log\ngeneral_log             = 0\nslow_query_log_file     = /var/lib/mysql/slow_queries.log\nslow_query_log          = 1\ninnodb_file_per_table   = 1\ninnodb_flush_method     = O_DIRECT\ninnodb_fast_shutdown    = 0\ninnodb_log_file_size    = 16M\nskip-name-resolve       = 1\nkey_buffer_size         = 16M\nread_buffer_size        = 60K\nsort_buffer_size        = 1M\ninnodb_buffer_pool_size = 64M\ntmp_table_size          = 8M\nmax_allowed_packet      = 16M\nthread_stack            = 192K\nthread_cache_size       = 8\ntable_open_cache        = 2000\ntable_definition_cache  = 1400\nperformance_schema      = ON\nopen_files_limit        = 32000\n > /etc/my.cnf.d/container.cnf dnf install -y \n centreon-engine \n centreon-plugin-Applications-Databases-Mysql \n centreon-plugin-Applications-Monitoring-Centreon-Central \n centreon-plugin-Applications-Monitoring-Centreon-Database \n centreon-plugin-Applications-Monitoring-Centreon-Map4-Jmx \n centreon-plugin-Applications-Monitoring-Centreon-Poller \n centreon-plugin-Applications-Protocol-Dns \n centreon-plugin-Applications-Protocol-Ftp \n centreon-plugin-Applications-Protocol-Http \n centreon-plugin-Applications-Protocol-Ldap \n centreon-plugin-Hardware-Printers-Generic-Snmp \n centreon-plugin-Hardware-Ups-Standard-Rfc1628-Snmp \n centreon-plugin-Network-Cisco-Standard-Snmp \n centreon-plugin-Operatingsystems-Linux-Snmp \n centreon-plugin-Operatingsystems-Windows-Snmp \n nagios-plugins \n nagios-plugins-dhcp \n nagios-plugins-icmp dnf clean all --enablerepo=* EOF",
          "system_commands": [
            "bash -e <<EOF dnf install -y dnf-plugins-core dnf config-manager --set-enabled crb dnf install -y epel-release dnf config-manager --add-repo https://packages.centreon.com/rpm-standard/${VERSION}/el9/centreon-${VERSION}.repo dnf config-manager --set-enabled centreon* dnf install -y  bc  brotli  bzip2  cronie  httpd  initscripts  jq  libsodium  libunwind  lua  openpgm  net-snmp  net-snmp-perl  net-snmp-utils  openssl  python3  rrdtool  rrdtool-perl  rsync  sed  sudo  zeromq dnf install -y  perl  perl-DBD-MySQL  perl-DBD-SQLite  perl-DBI  perl-EV  perl-FFI-CheckLib  perl-FFI-Platypus  perl-HTML-Parser  perl-NetAddr-IP  perl-Net-Curl  perl-Net-DNS  perl-Net-HTTP  perl-Net-Ping  perl-Pod-Parser  perl-Specio  perl-Test-Simple  perl-Unicode-Collate  perl-XML-LibXML  perl-XML-SAX  perl-XML-Twig  perl-UUID  perltidy dnf install -y libfaketime dnf module enable -y php:8.1 dnf install -y  php-common  php-cli  php-pdo  php-mysqlnd  php-gd  php-xml  php-mbstring  php-ldap  php-snmp  php-intl  php-fpm  php-curl  php-zip  php-pear  php-json curl -LsS https://r.mariadb.com/downloads/mariadb_repo_setup  | bash -s -- --os-type=rhel --skip-check-installed --os-version=9 --mariadb-server-version=mariadb-10.5 dnf install -y mariadb-server mariadb echo [server]log_output=FILEgeneral_log_file        = /var/lib/mysql/queries.loggeneral_log             = 0slow_query_log_file     = /var/lib/mysql/slow_queries.logslow_query_log          = 1innodb_file_per_table   = 1innodb_flush_method     = O_DIRECTinnodb_fast_shutdown    = 0innodb_log_file_size    = 16Mskip-name-resolve       = 1key_buffer_size         = 16Mread_buffer_size        = 60Ksort_buffer_size        = 1Minnodb_buffer_pool_size = 64Mtmp_table_size          = 8Mmax_allowed_packet      = 16Mthread_stack            = 192Kthread_cache_size       = 8table_open_cache        = 2000table_definition_cache  = 1400performance_schema      = ONopen_files_limit        = 32000 > /etc/my.cnf.d/container.cnf dnf install -y  centreon-engine  centreon-plugin-Applications-Databases-Mysql  centreon-plugin-Applications-Monitoring-Centreon-Central  centreon-plugin-Applications-Monitoring-Centreon-Database  centreon-plugin-Applications-Monitoring-Centreon-Map4-Jmx  centreon-plugin-Applications-Monitoring-Centreon-Poller  centreon-plugin-Applications-Protocol-Dns  centreon-plugin-Applications-Protocol-Ftp  centreon-plugin-Applications-Protocol-Http  centreon-plugin-Applications-Protocol-Ldap  centreon-plugin-Hardware-Printers-Generic-Snmp  centreon-plugin-Hardware-Ups-Standard-Rfc1628-Snmp  centreon-plugin-Network-Cisco-Standard-Snmp  centreon-plugin-Operatingsystems-Linux-Snmp  centreon-plugin-Operatingsystems-Windows-Snmp  nagios-plugins  nagios-plugins-dhcp  nagios-plugins-icmp dnf clean all --enablerepo=* EOF"
          ],
          "comment": "buildkit.dockerfile.v0",
          "is_buildkit_instruction": true,
          "inst_set_time_bucket": "2024-01-11T03:15:00+01:00",
          "inst_set_time_index": 1,
          "inst_set_time_reverse_index": 1
        },
        {
          "type": "COPY",
          "time": "2024-01-11T02:18:05Z",
          "is_nop": false,
          "local_image_exists": false,
          "layer_index": 0,
          "size": 302292,
          "size_human": "302 kB",
          "params": "./.github/docker/centreon-web/init/systemctl /bin/systemctl",
          "command_snippet": "COPY ./.github/docker/centreon-web/init/syst...",
          "command_all": "COPY ./.github/docker/centreon-web/init/systemctl /bin/systemctl",
          "comment": "buildkit.dockerfile.v0",
          "is_buildkit_instruction": true,
          "inst_set_time_bucket": "2024-01-11T03:15:00+01:00",
          "inst_set_time_index": 1,
          "inst_set_time_reverse_index": 1
        },
        {
          "type": "COPY",
          "time": "2024-01-11T02:18:05Z",
          "is_nop": false,
          "local_image_exists": false,
          "layer_index": 0,
          "size": 315434,
          "size_human": "315 kB",
          "params": "./.github/docker/centreon-web/init/* /etc/init.d/",
          "command_snippet": "COPY ./.github/docker/centreon-web/init/* /e...",
          "command_all": "COPY ./.github/docker/centreon-web/init/* /etc/init.d/",
          "comment": "buildkit.dockerfile.v0",
          "is_buildkit_instruction": true,
          "inst_set_time_bucket": "2024-01-11T03:15:00+01:00",
          "inst_set_time_index": 1,
          "inst_set_time_reverse_index": 1
        },
        {
          "type": "ARG",
          "time": "2024-01-11T16:02:31Z",
          "is_nop": false,
          "local_image_exists": false,
          "layer_index": 0,
          "size": 0,
          "params": "VERSION",
          "command_snippet": "ARG VERSION",
          "command_all": "ARG VERSION",
          "comment": "buildkit.dockerfile.v0",
          "is_buildkit_instruction": true,
          "inst_set_time_bucket": "2024-01-11T17:00:00+01:00",
          "inst_set_time_index": 2,
          "inst_set_time_reverse_index": 0
        },
        {
          "type": "COPY",
          "time": "2024-01-11T16:02:31Z",
          "is_nop": false,
          "local_image_exists": false,
          "layer_index": 0,
          "size": 12092142,
          "size_human": "12 MB",
          "params": "*.rpm /tmp/rpms-centreon/",
          "command_snippet": "COPY *.rpm /tmp/rpms-centreon/",
          "command_all": "COPY *.rpm /tmp/rpms-centreon/",
          "comment": "buildkit.dockerfile.v0",
          "is_buildkit_instruction": true,
          "inst_set_time_bucket": "2024-01-11T17:00:00+01:00",
          "inst_set_time_index": 2,
          "inst_set_time_reverse_index": 0
        },
        {
          "type": "COPY",
          "time": "2024-01-11T16:02:31Z",
          "is_nop": false,
          "local_image_exists": false,
          "layer_index": 0,
          "size": 2741,
          "size_human": "2.7 kB",
          "params": "./.github/docker/centreon-web/alma9/entrypoint /tmp/entrypoint",
          "command_snippet": "COPY ./.github/docker/centreon-web/alma9/ent...",
          "command_all": "COPY ./.github/docker/centreon-web/alma9/entrypoint /tmp/entrypoint",
          "comment": "buildkit.dockerfile.v0",
          "is_buildkit_instruction": true,
          "inst_set_time_bucket": "2024-01-11T17:00:00+01:00",
          "inst_set_time_index": 2,
          "inst_set_time_reverse_index": 0
        },
        {
          "type": "COPY",
          "time": "2024-01-11T16:02:31Z",
          "is_nop": false,
          "local_image_exists": false,
          "layer_index": 0,
          "size": 2329,
          "size_human": "2.3 kB",
          "params": "./.github/docker/centreon-web/alma9/configuration /tmp/configuration",
          "command_snippet": "COPY ./.github/docker/centreon-web/alma9/con...",
          "command_all": "COPY ./.github/docker/centreon-web/alma9/configuration /tmp/configuration",
          "comment": "buildkit.dockerfile.v0",
          "is_buildkit_instruction": true,
          "inst_set_time_bucket": "2024-01-11T17:00:00+01:00",
          "inst_set_time_index": 2,
          "inst_set_time_reverse_index": 0
        },
        {
          "type": "COPY",
          "time": "2024-01-11T16:02:31Z",
          "is_nop": false,
          "local_image_exists": false,
          "layer_index": 0,
          "size": 85209,
          "size_human": "85 kB",
          "params": "./.github/docker/centreon-web/sql/* /usr/local/src/sql/data/",
          "command_snippet": "COPY ./.github/docker/centreon-web/sql/* /us...",
          "command_all": "COPY ./.github/docker/centreon-web/sql/* /usr/local/src/sql/data/",
          "comment": "buildkit.dockerfile.v0",
          "is_buildkit_instruction": true,
          "inst_set_time_bucket": "2024-01-11T17:00:00+01:00",
          "inst_set_time_index": 2,
          "inst_set_time_reverse_index": 0
        },
        {
          "type": "RUN",
          "time": "2024-01-11T16:03:59Z",
          "is_nop": false,
          "local_image_exists": false,
          "layer_index": 0,
          "size": 187519297,
          "size_human": "188 MB",
          "command_snippet": "RUN bash -ex <<EOF rm -f /tmp/rpms-centreon/...",
          "command_all": "RUN bash -ex <<EOF rm -f /tmp/rpms-centreon/centreon-${VERSION}*.rpm /tmp/rpms-centreon/centreon-central-${VERSION}*.rpm /tmp/rpms-centreon/centreon-database-${VERSION}*.rpm dnf install -y /tmp/rpms-centreon/centreon-*.rpm systemctl stop centreon systemctl stop httpd systemctl stop php-fpm mv /tmp/entrypoint/container.sh /usr/share/centreon/container.sh mv /tmp/entrypoint/container.d /usr/share/centreon/container.d chmod -R 755 /usr/share/centreon/container.* mkdir /usr/share/centreon/www/install/tmp mv /tmp/configuration/* /usr/share/centreon/www/install/tmp/ chown -R apache:apache /usr/share/centreon/www/install/tmp echo date.timezone = Europe/Paris > /etc/php.d/centreon.ini touch /var/log/php-fpm/centreon-error.log chown apache:apache /var/log/php-fpm/centreon-error.log service mysql start mysql -e GRANT ALL ON *.* to 'root'@'localhost' IDENTIFIED BY 'centreon' WITH GRANT OPTION cd /usr/share/centreon/www/install/steps/process su apache -s /bin/bash -c php configFileSetup.php su apache -s /bin/bash -c php installConfigurationDb.php su apache -s /bin/bash -c php installStorageDb.php su apache -s /bin/bash -c php createDbUser.php su apache -s /bin/bash -c SERVER_ADDR='127.0.0.1' php insertBaseConf.php su apache -s /bin/bash -c php partitionTables.php su apache -s /bin/bash -c php generationCache.php su apache -s /bin/bash -c rm -rf /usr/share/centreon/www/install mysql -pcentreon -e GRANT ALL ON *.* to 'root'@'localhost' IDENTIFIED BY '' WITH GRANT OPTION mysql -e GRANT ALL ON *.* to 'root'@'%' IDENTIFIED BY 'centreon' WITH GRANT OPTION dnf install -y https://github.com/mydumper/mydumper/releases/download/v0.15.1-3/mydumper-0.15.1-3.el9.x86_64.rpm zstd mkdir -p /usr/local/src/sql/databases mydumper -h localhost -P 3306 -u root -G -o /usr/local/src/sql/databases/centreon -B centreon mydumper -h localhost -P 3306 -u root -G -o /usr/local/src/sql/databases/centreon_storage -B centreon_storage service mysql stop dnf remove -y mariadb-server galera-4 rm -rf /var/lib/mysql sed -i s#severity=error#severity=debug# /etc/sysconfig/gorgoned sed -i 5s/.*/    id: 1/ /etc/centreon-gorgone/config.d/40-gorgoned.yaml sed -i s#enable: true#enable: false# /etc/centreon-gorgone/config.d/50-centreon-audit.yaml dnf clean all EOF",
          "system_commands": [
            "bash -ex <<EOF rm -f /tmp/rpms-centreon/centreon-${VERSION}*.rpm /tmp/rpms-centreon/centreon-central-${VERSION}*.rpm /tmp/rpms-centreon/centreon-database-${VERSION}*.rpm dnf install -y /tmp/rpms-centreon/centreon-*.rpm systemctl stop centreon systemctl stop httpd systemctl stop php-fpm mv /tmp/entrypoint/container.sh /usr/share/centreon/container.sh mv /tmp/entrypoint/container.d /usr/share/centreon/container.d chmod -R 755 /usr/share/centreon/container.* mkdir /usr/share/centreon/www/install/tmp mv /tmp/configuration/* /usr/share/centreon/www/install/tmp/ chown -R apache:apache /usr/share/centreon/www/install/tmp echo date.timezone = Europe/Paris > /etc/php.d/centreon.ini touch /var/log/php-fpm/centreon-error.log chown apache:apache /var/log/php-fpm/centreon-error.log service mysql start mysql -e GRANT ALL ON *.* to 'root'@'localhost' IDENTIFIED BY 'centreon' WITH GRANT OPTION cd /usr/share/centreon/www/install/steps/process su apache -s /bin/bash -c php configFileSetup.php su apache -s /bin/bash -c php installConfigurationDb.php su apache -s /bin/bash -c php installStorageDb.php su apache -s /bin/bash -c php createDbUser.php su apache -s /bin/bash -c SERVER_ADDR='127.0.0.1' php insertBaseConf.php su apache -s /bin/bash -c php partitionTables.php su apache -s /bin/bash -c php generationCache.php su apache -s /bin/bash -c rm -rf /usr/share/centreon/www/install mysql -pcentreon -e GRANT ALL ON *.* to 'root'@'localhost' IDENTIFIED BY '' WITH GRANT OPTION mysql -e GRANT ALL ON *.* to 'root'@'%' IDENTIFIED BY 'centreon' WITH GRANT OPTION dnf install -y https://github.com/mydumper/mydumper/releases/download/v0.15.1-3/mydumper-0.15.1-3.el9.x86_64.rpm zstd mkdir -p /usr/local/src/sql/databases mydumper -h localhost -P 3306 -u root -G -o /usr/local/src/sql/databases/centreon -B centreon mydumper -h localhost -P 3306 -u root -G -o /usr/local/src/sql/databases/centreon_storage -B centreon_storage service mysql stop dnf remove -y mariadb-server galera-4 rm -rf /var/lib/mysql sed -i s#severity=error#severity=debug# /etc/sysconfig/gorgoned sed -i 5s/.*/    id: 1/ /etc/centreon-gorgone/config.d/40-gorgoned.yaml sed -i s#enable: true#enable: false# /etc/centreon-gorgone/config.d/50-centreon-audit.yaml dnf clean all EOF"
          ],
          "comment": "buildkit.dockerfile.v0",
          "is_buildkit_instruction": true,
          "inst_set_time_bucket": "2024-01-11T17:00:00+01:00",
          "inst_set_time_index": 2,
          "inst_set_time_reverse_index": 0
        },
        {
          "type": "EXPOSE",
          "time": "2024-01-11T16:03:59Z",
          "is_nop": false,
          "local_image_exists": false,
          "layer_index": 0,
          "size": 0,
          "params": "3306/tcp:{} 80/tcp",
          "command_snippet": "EXPOSE 3306/tcp:{} 80/tcp",
          "command_all": "EXPOSE 3306/tcp:{} 80/tcp",
          "comment": "buildkit.dockerfile.v0",
          "is_buildkit_instruction": true,
          "inst_set_time_bucket": "2024-01-11T17:00:00+01:00",
          "inst_set_time_index": 2,
          "inst_set_time_reverse_index": 0
        },
        {
          "type": "ENTRYPOINT",
          "time": "2024-01-11T16:03:59Z",
          "is_nop": false,
          "is_exec_form": true,
          "local_image_exists": false,
          "layer_index": 0,
          "size": 0,
          "params": "[\"/usr/share/centreon/container.sh\"]\n",
          "command_snippet": "ENTRYPOINT [\"/usr/share/centreon/container.s...",
          "command_all": "ENTRYPOINT [\"/usr/share/centreon/container.sh\"]\n",
          "comment": "buildkit.dockerfile.v0",
          "is_buildkit_instruction": true,
          "inst_set_time_bucket": "2024-01-11T17:00:00+01:00",
          "inst_set_time_index": 2,
          "inst_set_time_reverse_index": 0
        },
        {
          "type": "ENV",
          "time": "2024-01-11T16:03:59Z",
          "is_last_instruction": true,
          "is_nop": false,
          "local_image_exists": true,
          "layer_index": 0,
          "size": 0,
          "params": "CENTREON_DATASET=1",
          "command_snippet": "ENV CENTREON_DATASET=1",
          "command_all": "ENV CENTREON_DATASET=1",
          "comment": "buildkit.dockerfile.v0",
          "raw_tags": [
            "docker.centreon.com/centreon/centreon-web-alma9:MON-23368-containers"
          ],
          "is_buildkit_instruction": true,
          "inst_set_time_bucket": "2024-01-11T17:00:00+01:00",
          "inst_set_time_index": 2,
          "inst_set_time_reverse_index": 0
        }
      ]
    }
  ],
  "image_created": false,
  "image_build_engine": ""
}
